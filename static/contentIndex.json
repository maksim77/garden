{"index":{"title":"index","links":["notes/Development/YandexGPT-в-Obsidian-TextGenerator"],"tags":[],"content":"Index\n\nYandexGPT в Obsidian TextGenerator\n"},"notes/Development/00_GRPC":{"title":"00_GRPC","links":["notes/Development/00_GRPC","notes/Development/Установка-GRPC-в-Golang","notes/Development/Компиляция-proto-файла-для-Golang","notes/Development/Подключение-к-GRPC-server'у","notes/Development/Создание-перехватчика-GRPC","notes/Development/GRPC-Reflection"],"tags":["reference/golang"],"content":"00_GRPC\n\nУстановка GRPC в Golang\nКомпиляция proto файла для Golang\nПодключение к GRPC server’у\nСоздание перехватчика GRPC\nGRPC Reflection\n"},"notes/Development/Draft-actions":{"title":"Draft actions","links":["notes/Development/Draft-actions"],"tags":[],"content":"Draft actions\nI really like the Draft app, and I have written a number of actions for it. I wrote them for myself, but some of them seemed interesting enough for me to share with everyone.\n\nMastodon Reply - simple action that allows you to reply to Mastodon toot directly from within Draft.\nCalendar - this action takes all of today’s events from the calendar and creates a markdown for Obsidian Daily Notes.\n"},"notes/Development/GRPC-Reflection":{"title":"GRPC Reflection","links":["notes/Development/GRPC-Reflection"],"tags":["reference/golang"],"content":"GRPC Reflection\nСуществует возможность получать список методов, узнавать описания сообщений и даже вызывать методы с помощью утилиты командной строки grpc_cli.\nСборка утилиты\n\nКлонировать grpc репозиторий\ngit submodule update --init\nmkdir -p cmake/build\ncd cmake/build\ncmake -DgRPC_BUILD_TESTS=ON ../..\nmake grpc_cli\n\nНастройка севера для работы с reflection\nimport &quot;google.golang.org/grpc/reflection&quot;\n \ns := grpc.NewServer()\nreflection.Register(s)"},"notes/Development/Git-user-checks":{"title":"Git user checks","links":["notes/Development/Git-user-checks"],"tags":[],"content":"Git user checks\n\nVSCode Marketplace\nGitHub\n\nSometimes, after cloning a repository from a corporate git server and sending several commits to it, you realize that you forgot to change the user settings in git.\nThis extension was written to avoid that.\nYou only need to define three parameters. The first is the domain that the extension will look for in the origin section of the repository that you opened in VSCode.\nThe other two are user settings that need to be set for the repository cloned from the domain specified in the first paragraph.\n\nThat’s it! The extension will warn you that you are working with a repository for which user settings should be set (if they are not already set). Clicking the “Overwrite” button will automatically add the necessary parameters to the git settings of the current project.\n"},"notes/Development/YandexGPT-в-Obsidian-TextGenerator":{"title":"YandexGPT в Obsidian TextGenerator","links":["notes/Development/YandexGPT-в-Obsidian-TextGenerator","notes/Development/Получение-IAM_TOKEN-в-YC","notes/Development/Получение-API-ключа-в-YC","notes/Development/Получение-ID-каталога-в-Yandex-Cloud"],"tags":[],"content":"YandexGPT в Obsidian TextGenerator\nДля того чтобы работать с API YandexGPT необходимо быть зарегистрированным в Yandex Cloud и иметь действующий платежный аккаунт.\nДля авторизации в API потребуется либо IAM токен либо API ключ.\n\nПолучение IAM_TOKEN в YC\nПолучение API ключа в YC\n\nObsidian\n\nУстановить плагин TextGenerator\nВыбрать Provider Profile - Custom или клонировать его нажав +\n\nВ поле Endpoint указать llm.api.cloud.yandex.net/foundationModels/v1/completion\nВ поле API Key указать либо IAM_TOKEN либо API ключ полученный ранее\n\nAdvanced mode\nДальнейшие пункты настраиваются после включения переключателя Advanced mode.\n\nВ секции Headers указываем следующее при использовании ключа API.\n\n{\n    &quot;Content-Type&quot;: &quot;application/json&quot;,\n    &quot;Authorization&quot;: &quot;Api-Key {{api_key}}&quot;, \n    &quot;x-folder-id&quot;: &quot;b1gjpq05r3ppsou34c7d&quot;\n}\nИли вот так при при использовании IAM токена:\n{\n    &quot;Content-Type&quot;: &quot;application/json&quot;,\n    &quot;Authorization&quot;: &quot;Bearer {{api_key}}&quot;, \n    &quot;x-folder-id&quot;: &quot;b1gjpq05r3ppsou34c7d&quot;\n}\nВ x-folder-id необходимо подставить идентификатор того каталога для которого создавался ключ/токен.\n\nВ секции Body пропишем тело запроса\n\n{\n  &quot;modelUri&quot;: &quot;gpt://b1gjpq05r3ppsou34c7d/yandexgpt/latest&quot;,\n  &quot;completionOptions&quot;: {\n    &quot;stream&quot;: false,\n    &quot;temperature&quot;: {{temperature}},\n    &quot;maxTokens&quot;: {{max_tokens}}\n  },\n  &quot;messages&quot;:  [{&quot;text&quot;:  {{stringify tg_selection}}, &quot;role&quot;:&quot;user&quot;}] \n}\nГде modelUri это адрес модели выключающий в себя идентификатор каталога из шагов выше. Список существующих моделей можно посмотреть тут.\n\nВ секции Response Sanatization прописываем обработчик ответов API:\n\nif (res.status &gt;= 300) {\n  const err = data?.error?.message || JSON.stringify(data);\n  throw err;\n}\n \nconst choices = data.result.alternatives.map(c =&gt; ({ content: c.message.text }));\n \nreturn choices;\n\nОбязательно устанавливаем галочку CORS Bypass\n\nЭкспортированный профиль\nTextGenerator поддерживает импорт-экспорт профилей. Ниже приведен сохраненный результат описывающий действия выше.\n{\n  id: &#039;Default (Custom) 2&#039;,\n  profile: {\n    extends: &#039;Default (Custom)&#039;,\n    name: &#039;YandexGPT&#039;,\n  },\n  config: {\n    endpoint: &#039;llm.api.cloud.yandex.net/foundationModels/v1/completion&#039;,\n    custom_header: &#039;{\\n    &quot;Content-Type&quot;: &quot;application/json&quot;,\\n    &quot;Authorization&quot;: &quot;Api-Key {{api_key}}&quot;, \\n&quot;x-folder-id&quot;: &quot;b1gjpq05r3ppsou34c7d&quot;\\n}&#039;,\n    custom_body: &#039;{\\n  &quot;modelUri&quot;: &quot;gpt://b1gjpq05r3ppsou34c7d/yandexgpt/latest&quot;,\\n  &quot;completionOptions&quot;: {\\n    &quot;stream&quot;: false,\\n    &quot;temperature&quot;: {{temperature}},\\n    &quot;maxTokens&quot;: {{max_tokens}}\\n  },\\n  &quot;messages&quot;:  [{&quot;text&quot;:  {{stringify tg_selection}}, &quot;role&quot;:&quot;user&quot;}] \\n}\\n&#039;,\n    model: &#039;gpt-3.5-turbo-16k&#039;,\n    sanatization_streaming: &#039;// catch error\\nif (res.status &gt;= 300) {\\n  const err = data?.error?.message || JSON.stringify(data);\\n  throw err;\\n}\\nlet resultText = &quot;&quot;;\\nconst lines = chunk.split(&quot;\\ndata: &quot;);\\n\\nconst parsedLines = lines\\n    .map((line) =&gt; line.replace(/^data: /, &quot;&quot;).trim()) // Remove the &quot;data: &quot; prefix\\n    .filter((line) =&gt; line !== &quot;&quot; &amp;&amp; line !== &quot;[DONE]&quot;) // Remove empty lines and &quot;[DONE]&quot;\\n    .map((line) =&gt; {\\n        try {\\n            return JSON.parse(line)\\n        } catch { }\\n    }) // Parse the JSON string\\n    .filter(Boolean);\\n\\nfor (const parsedLine of parsedLines) {\\n    const { choices } = parsedLine;\\n    const { delta } = choices[0];\\n    const { content } = delta;\\n    // Update the UI with the new content\\n    if (content) {\\n        resultText += content;\\n    }\\n}\\nreturn resultText;&#039;,\n    sanatization_response: &#039;if (res.status &gt;= 300) {\\n  const err = data?.error?.message || JSON.stringify(data);\\n  throw err;\\n}\\n\\nconst choices = data.result.alternatives.map(c =&gt; ({ content: c.message.text }));\\n\\nreturn choices;&#039;,\n    frequency_penalty: 0,\n    presence_penalty: 0.5,\n    top_p: 1,\n    CORSBypass: true,\n    streamable: false,\n    api_key: &#039;&#039;,\n  },\n}"},"notes/Development/Компиляция-proto-файла-для-Golang":{"title":"Компиляция proto файла для Golang","links":["notes/Development/Компиляция-proto-файла-для-Golang"],"tags":["reference/golang"],"content":"Компиляция proto файла для Golang\nsyntax = &quot;proto3&quot;;\npackage ecommerce;\n \nservice ProductInfo {\n    rpc addProduct(Product) returns (ProductID);\n    rpc getProduct(ProductID) returns(Product);\n};\n \nmessage Product {\n    string id = 1;\n    string name = 2;\n    string description = 3;\n};\n \nmessage ProductID {\n    string value = 1;\n};\nprotoc --go-grpc_out=. --go-grpc_opt=Mecommerce/product_info.proto=./ecommerce --go_out=. --go_opt=Mecommerce/product_info.proto=./ecommerce  ecommerce/product_info.proto\nАльтернативой указания значений Mecommerce/product_info.proto=./ecommerce может стать определение значений go_package в proto:\noption go_package = &quot;./;investapi&quot;;\n"},"notes/Development/Подключение-к-GRPC-server'у":{"title":"Подключение к GRPC server'у","links":["notes/Development/Подключение-к-GRPC-server'у"],"tags":["reference/golang"],"content":"Подключение к GRPC server’у\nSimple server\nСоздание сервера\ntype server struct {\n\tproductMap map[string]*pb.Product\n\tecommerce.UnimplementedProductInfoServer\n}\n \nconst (\n\tport = &quot;:50051&quot;\n)\n \nfunc main() {\n\tlis, err := net.Listen(&quot;tcp&quot;, port)\n\tif err != nil {\n\t\tlog.Fatal(err)\n\t}\n\ts := grpc.NewServer()\n\tecommerce.RegisterProductInfoServer(s, &amp;server{})\n\tlog.Printf(&quot;Starting gRPC listener on port %s&quot;, port)\n\tif err := s.Serve(lis); err != nil {\n\t\tlog.Fatalf(&quot;failed serve: %v&quot;, err)\n\t}\n}\nСоздание клиента\npackage main\n \nimport (\n\t&quot;context&quot;\n\t&quot;log&quot;\n\t&quot;time&quot;\n \n\t&quot;client/ecommerce&quot;\n \n\t&quot;google.golang.org/grpc&quot;\n\t&quot;google.golang.org/grpc/credentials/insecure&quot;\n)\n \nconst (\n\taddress = &quot;localhost:50051&quot;\n)\n \nfunc main() {\n\tconn, err := grpc.Dial(address, grpc.WithTransportCredentials(insecure.NewCredentials()))\n\tif err != nil {\n\t\tlog.Fatal(err)\n\t}\n\tdefer conn.Close()\n \n\tc := ecommerce.NewProductInfoClient(conn)\n\tname := &quot;Apple iPhone 11&quot;\n\tdescription := &quot;Some phone&quot;\n \n\tctx, cancel := context.WithTimeout(context.Background(), time.Second)\n\tdefer cancel()\n\tr, err := c.AddProduct(ctx, &amp;ecommerce.Product{Name: name, Description: description})\n\tif err != nil {\n\t\tlog.Fatal(err)\n\t}\n\tlog.Printf(&quot;Product ID: %s added successfully&quot;, r.Value)\n \n\tproduct, err := c.GetProduct(ctx, &amp;ecommerce.ProductID{Value: r.Value})\n\tif err != nil {\n\t\tlog.Fatal(err)\n\t}\n\tlog.Printf(&quot;Product: %s&quot;, product.String())\n}\nTinkoff OpenAPI\nconn, err := grpc.Dial(&quot;invest-public-api.tinkoff.ru:443&quot;,\n\tgrpc.WithTransportCredentials(credentials.NewTLS(&amp;tls.Config{})),\n\tgrpc.WithPerRPCCredentials(oauth.TokenSource{\n\t\tTokenSource: oauth2.StaticTokenSource(&amp;oauth2.Token{\n\t\t\tAccessToken: &quot;token&quot;,\n\t\t\t}),\n\t\t}))\n\tif err != nil {\n\t\tlog.Fatalf(&quot;did not connect: %v&quot;, err)\n\t}\n\tdefer conn.Close()\nПосле чего объект conn можно передавать в функции создание новых сервисов."},"notes/Development/Получение-API-ключа-в-YC":{"title":"Получение API ключа в YC","links":["notes/Development/Получение-API-ключа-в-YC","notes/Development/Получение-списка-Service-Account-в-YC"],"tags":[],"content":"Получение API ключа в YC\nЭто инструкция по созданию API-ключа для сервисного аккаунта. API-ключ — секретный ключ, используемый для упрощенной авторизации в API Yandex Cloud.\nЕсли у вас еще нет сервисного аккаунта, создайте его и назначьте ему роли.\nЧтобы создать API-ключ:\n\nСоздайте API-ключ с помощью метода REST API create для ресурса ApiKey:\n\nexport SERVICEACCOUNT_ID=&lt;идентификатор_сервисного_аккаунта&gt;\nexport IAM_TOKEN=&lt;токен&gt;\ncurl -X POST \\\n  -H &quot;Content-Type: application/json&quot; \\\n  -H &quot;Authorization: Bearer $IAM_TOKEN&quot; \\\n  -d &quot;{\n      \\&quot;serviceAccountId\\&quot;: \\&quot;$SERVICEACCOUNT_ID\\&quot;,\n      \\&quot;scope\\&quot;: \\&quot;&lt;область_действия&gt;\\&quot;,\n      \\&quot;expiresAt\\&quot;: \\&quot;&lt;дата_и_время&gt;\\&quot;\n  }&quot; \\\n  iam.api.cloud.yandex.net/iam/v1/apiKeys\nГде:\n\nSERVICEACCOUNT_ID — идентификатор сервисного аккаунта. Обязательный параметр.\nIAM_TOKEN — IAM-токен. Обязательный параметр.\nscope — область действия для ключа с ограниченным доступом. Необязательный параметр.\nexpiresAt — дата и время истечения срока действия ключа с ограниченным доступом. Необязательный параметр.\n"},"notes/Development/Получение-IAM_TOKEN-в-YC":{"title":"Получение IAM_TOKEN в YC","links":["notes/Development/Получение-IAM_TOKEN-в-YC"],"tags":[],"content":"Получение IAM_TOKEN в YC\n\nВойдите- в ваш аккаунт на Яндексе.\nПолучите OAuth-токен в сервисе Яндекс.OAuth. Для этого перейдите по ссылке, нажмите Разрешить и скопируйте полученный OAuth-токен.\nОбменяйте OAuth-токен на IAM-токен:\n\ncurl -X POST \\\n  -d &#039;{&quot;yandexPassportOauthToken&quot;:&quot;&lt;OAuth-токен&gt;&quot;}&#039; \\\n  iam.api.cloud.yandex.net/iam/v1/tokens"},"notes/Development/Получение-ID-каталога-в-Yandex-Cloud":{"title":"Получение ID каталога в Yandex Cloud","links":["notes/Development/Получение-ID-каталога-в-Yandex-Cloud","notes/Development/Получение-ID-облака-в-Yandex-Cloud"],"tags":[],"content":"Получение ID каталога в Yandex Cloud\nДля использования многих методов API YC требуется знать идентификатор каталога в облаке.\nПолучение id облака\nИдентификатор самого облака в свою очередь можно получить вот так:\nTransclude of Получение-ID-облака-в-Yandex-Cloud\nПолучение id каталога(в)\nhttp GET resource-manager.api.cloud.yandex.net/resource-manager/v1/folders Authorization:&quot;Bearer $IAM_TOKEN&quot; cloud_id=b1gp230h62h8oavhctri\nОтвет:\n{\n    &quot;folders&quot;: [\n        {\n            &quot;cloudId&quot;: &quot;b1gp230h62h8oavhctri&quot;,\n            &quot;createdAt&quot;: &quot;2020-09-19T07:20:09Z&quot;,\n            &quot;id&quot;: &quot;b1gjpq05r3ppsou34c7d&quot;,\n            &quot;name&quot;: &quot;default&quot;,\n            &quot;status&quot;: &quot;ACTIVE&quot;\n        }\n    ]\n}"},"notes/Development/Получение-ID-облака-в-Yandex-Cloud":{"title":"Получение ID облака в Yandex Cloud","links":["notes/Development/Получение-ID-облака-в-Yandex-Cloud","notes/Development/Получение-IAM_TOKEN-в-YC"],"tags":[],"content":"Получение ID облака в Yandex Cloud\nДля того чтобы узнать id облаков доступных в YC необходимо выполнить следующий запрос (необходим I AM токен):\nhttp GET resource-manager.api.cloud.yandex.net/resource-manager/v1/clouds  Authorization:&quot;Bearer $IAM_TOKEN&quot;\nОтвет:\n{\n    &quot;clouds&quot;: [\n        {\n            &quot;createdAt&quot;: &quot;2020-09-19T07:20:09Z&quot;,\n            &quot;id&quot;: &quot;b1gp230h62h8oavhctri&quot;,\n            &quot;name&quot;: &quot;maksim77&quot;,\n            &quot;organizationId&quot;: &quot;bpfulqitoarhlo1a29ln&quot;\n        }\n    ]\n}"},"notes/Development/Получение-списка-Service-Account-в-YC":{"title":"Получение списка Service Account в YC","links":["notes/Development/Получение-списка-Service-Account-в-YC","notes/Development/Получение-IAM_TOKEN-в-YC"],"tags":[],"content":"Получение списка Service Account в YC\nНеобходимо получить IAM_TOKEN и знать идентификатор каталога (FOLDER_ID).\nexport FOLDER_ID=b1gvmob95yys********\nexport IAM_TOKEN=CggaATEVAgA...\ncurl -H &quot;Authorization: Bearer ${IAM_TOKEN}&quot; \\\n  &quot;iam.api.cloud.yandex.net/iam/v1/serviceAccounts${FOLDER_ID}&quot;\n \n{\n &quot;serviceAccounts&quot;: [\n  {\n   &quot;id&quot;: &quot;ajebqtreob2d********&quot;,\n   &quot;folderId&quot;: &quot;b1gvmob95yys********&quot;,\n   &quot;createdAt&quot;: &quot;2018-10-18T13:42:40Z&quot;,\n   &quot;name&quot;: &quot;my-robot&quot;,\n   &quot;description&quot;: &quot;my description&quot;\n  }\n ]\n}"},"notes/Development/Установка-GRPC-в-Golang":{"title":"Установка GRPC в Golang","links":["notes/Development/Установка-GRPC-в-Golang"],"tags":["reference/golang"],"content":"Установка GRPC в Golang\nLinux\n$ apt install -y protobuf-compiler\n$ protoc --version  # Ensure compiler version is 3+\nMac OS\n$ brew install protobuf\n$ protoc --version  # Ensure compiler version is 3+\nGolang\n$ go install google.golang.org/protobuf/cmd/protoc-gen-go@v1.28\n$ go install google.golang.org/grpc/cmd/protoc-gen-go-grpc@v1.2"}}